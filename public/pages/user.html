<!doctype html>
<html>
  <head>
    <title>Whiskers | Login</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="og:title" content="Whiskers | Login" />
    <meta name="og:description" content="Whiskers - Super Secret Messaging" />
    <meta name="og:image" content="/media/image/icons/logo.png" />
    <link rel="icon" type="image/png" href="/media/image/icons/logo.png" />
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <load>
      <img src="/media/image/icons/logo.png" />
    </load>
    <nav>
      <img
        width="30px"
        height="30px"
        class="user"
        onclick="goto('/pages/user')"
        src="/media/image/icons/profile.png"
      />
      <a id="home" href="/">
        <img class="logo" src="/media/image/icons/logo.png" />
        Whiskers
      </a>
      <img
        width="30px"
        height="30px"
        class="settings"
        onclick="goto('/pages/settings')"
        src="/media/image/icons/settings.png"
      />
    </nav>
    <div class="center">
      <div class="lgin">
        <h3>Username</h3>
        <input placeholder="Username" id="username" type="text" />
        <h3>Password</h3>
        <input placeholder="Password" id="password" type="password" /><br />
        <button id="login" onclick="login()">Login</button>
        <button id="signup" onclick="signup()">Sign up</button>
      </div>
    </div>
    <script src="/js/all.js"></script>
    <script>
      const params = new URLSearchParams(window.location.search);
      const redirect = params.get("r");
      function login() {
        let username = document.getElementById("username").value;
        let password = document.getElementById("password").value;
        fetch("/api/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            username: username,
            password: password,
          }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.error) return popup(`${data.error}`);
            localStorage.setItem("account", data.name);
            if (redirect) return goto(redirect);
            goto("/pages/settings");
          });
      }

      function signup() {
        let username = document.getElementById("username").value;
        let password = document.getElementById("password").value;
        fetch("/api/signup", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            username: username,
            password: password,
          }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.error) return popup(`${data.error}`);
            localStorage.setItem("account", data.name);
            if (redirect) return goto(redirect);
            goto("/pages/settings");
          });
      }
    </script>
  </body>
</html>
